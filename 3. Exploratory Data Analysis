## First raw attempt at bar charts.
## Need to better handle fields with a large number of values.
## Need to address N/A values.

######################################################################
## Exploratory Data Analysis
######################################################################

## Install needed packages
library(ggplot2)
library(scales)
library(DataExplorer)

########## Exploratory Data Analysis with DataExplorer

## Explore DataExplorer Package

plot_str(HxMx)
plot_missing(HxMx)
plot_histogram(HxMx)
plot_density(HxMx)
plot_bar(HxMx)
create_report(HxMx)



########## Exploratory Data Analysis - Part 1: Single Variable

## Course ID
ggplot(data = HxMx) +
  geom_bar(mapping = aes(x = course_id)) +
  scale_x_discrete(name = " ") +
  scale_y_continuous(name=" ", labels = comma) +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_text(angle=90, vjust=0.5)) +
  labs(title = "Course ID")

## Institution
ggplot(data = HxMx) +
  geom_bar(mapping = aes(x = institution.x)) +
  scale_y_continuous(name=" ", labels = comma) +
  theme(axis.title.x = element_blank()) +
  labs(title = "Institution") 

#ggplot(data = HxMx) +
#  geom_bar(mapping = aes(x = institution.y)) +
#  scale_y_continuous(name=" ", labels = comma) +
#  theme(axis.title.x = element_blank()) +
#  labs(title = "Institution from Course") 
## THIS IS REPETITIVE

## Course Code
ggplot(data = HxMx) +
  geom_bar(mapping = aes(x = course_code)) +
  scale_y_continuous(name=" ", labels = comma) +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_text(angle=90, vjust=0.5)) +
  labs(title = "Course Code") 

## Year & Term
#ggplot(data = HxMx) +
#  geom_bar(mapping = aes(x = year_term)) +
#  scale_y_continuous(name=" ", labels = comma) +
#  theme(axis.title.x = element_blank()) +
#  labs(title = "Year & Term") 
## Repetitive and not as clean as Year and Term below

## Year
ggplot(data = HxMx) +
  geom_bar(mapping = aes(x = year)) +
  scale_y_continuous(name=" ", labels = comma) +
  theme(axis.title.x = element_blank()) +
  labs(title = "Year") 

## Term
ggplot(data = HxMx) +
  geom_bar(mapping = aes(x = term)) +
  scale_y_continuous(name=" ", labels = comma) +
  theme(axis.title.x = element_blank()) +
  labs(title = "Term") 

## Semester
## CLEAN UP - DUPLICATION IN VALUES
ggplot(data = HxMx) +
  geom_bar(mapping = aes(x = semester)) +
  scale_y_continuous(name=" ", labels = comma) +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_text(angle=90, vjust=0.5)) +
  labs(title = "Semester") 

## User ID
## Too many records to show cleanly
#ggplot(data = HxMx) +
#  geom_bar(mapping = aes(x = userid_DI)) +
#  theme(axis.title.x = element_blank()) +
#  labs(title = "User Id")

## Registered
ggplot(data = HxMx) +
  geom_bar(mapping = aes(x = registered)) +
  scale_y_continuous(name=" ", labels = comma) +
  theme(axis.title.x = element_blank()) +
  labs(title = "Registered")

## Viewed
ggplot(data = HxMx) +
  geom_bar(mapping = aes(x = viewed)) +
  scale_y_continuous(name=" ", labels = comma) +
  theme(axis.title.x = element_blank()) +
  labs(title = "Viewed") 

## Explored
ggplot(data = HxMx) +
  geom_bar(mapping = aes(x = explored)) +
  scale_y_continuous(name=" ", labels = comma) +
  theme(axis.title.x = element_blank()) +
  labs(title = "Explored") 

## Certified
ggplot(data = HxMx) +
  geom_bar(mapping = aes(x = certified)) +
  scale_y_continuous(name=" ", labels = comma) +
  theme(axis.title.x = element_blank()) +
  labs(title = "Certified") 

## Country code
ggplot(data = HxMx) +
  geom_bar(mapping = aes(x = final_cc_cname_DI)) +
  scale_x_discrete(name = " ") +
  scale_y_continuous(name=" ", labels = comma) +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_text(angle=90, vjust=0.5)) +
  labs(title = "Country Code")

## Level of education
ggplot(data = HxMx) +
  geom_bar(mapping = aes(x = LoE_DI)) +
  scale_x_discrete(name = " ") +
  scale_y_continuous(name=" ", labels = comma) +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_text(angle=90, vjust=0.5)) +
  labs(title = "Level of Education")

## Year of birth
ggplot(data = HxMx) +
  geom_bar(mapping = aes(x = YoB)) +
  scale_x_discrete(name = " ") +
  scale_y_continuous(name=" ", labels = comma) +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_text(angle=90, vjust=0.5)) +
  labs(title = "Year of Birth")

## Gender
ggplot(data = HxMx) +
  geom_bar(mapping = aes(x = gender)) +
  scale_y_continuous(name=" ", labels = comma) +
  theme(axis.title.x = element_blank()) +
  labs(title = "Gender") 

## Grade
ggplot(data = HxMx) +
  geom_bar(mapping = aes(x = grade)) +
  scale_y_continuous(name=" ", labels = comma) +
  theme(axis.title.x = element_blank()) +
  labs(title = "Grade") 

## Start time
ggplot(data = HxMx) +
  geom_bar(mapping = aes(x = start_time_DI)) +
  scale_x_date (name = " ") +
  scale_y_continuous(name=" ", labels = comma) +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_text(angle=90, vjust=0.5)) +
  labs(title = "Start Time")

## Last Event
ggplot(data = HxMx) +
  geom_bar(mapping = aes(x = last_event_DI)) +
  scale_x_date (name = " ") +
  scale_y_continuous(name=" ", labels = comma) +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_text(angle=90, vjust=0.5)) +
  labs(title = "Last Event")  

## Number of Events
ggplot(data = HxMx) +
  geom_bar(mapping = aes(x = nevents)) +
  scale_y_continuous(name=" ", labels = comma) +
  theme(axis.title.x = element_blank()) +
  labs(title = "Number of Events") 

## Number of Days
ggplot(data = HxMx) +
  geom_bar(mapping = aes(x = ndays_act)) +
  scale_y_continuous(name=" ", labels = comma) +
  theme(axis.title.x = element_blank()) +
  labs(title = "Number of Days") 

## Number of video plays
ggplot(data = HxMx) +
  geom_bar(mapping = aes(x = nplay_video)) +
  scale_y_continuous(name=" ", labels = comma) +
  theme(axis.title.x = element_blank()) +
  labs(title = "Number of Video Plays") 

## Number of chapters
ggplot(data = HxMx) +
  geom_bar(mapping = aes(x = nchapters)) +
  scale_y_continuous(name=" ", labels = comma) +
  theme(axis.title.x = element_blank()) +
  labs(title = "Number of Chapters") 

## Number of forum posts
ggplot(data = HxMx) +
  geom_bar(mapping = aes(x = nforum_posts)) +
  scale_y_continuous(name=" ", labels = comma) +
  theme(axis.title.x = element_blank()) +
  labs(title = "Number of Forum Posts") 

## Roles
## All values are NULL - remove
#ggplot(data = HxMx) +
#  geom_bar(mapping = aes(x = roles)) +
#  scale_y_continuous(name=" ", labels = comma) +
#  theme(axis.title.x = element_blank()) +
#  labs(title = "Roles") 

## Inconsistent Flag
ggplot(data = HxMx) +
  geom_bar(mapping = aes(x = incomplete_flag)) +
  scale_y_continuous(name=" ", labels = comma) +
  theme(axis.title.x = element_blank()) +
  labs(title = "Incomplete Flag") 

## Letter Grade
## CHANGE LETTER ORDER
ggplot(data = HxMx) +
  geom_bar(mapping = aes(x = letter_grade)) +
  scale_y_continuous(name=" ", labels = comma) +
  theme(axis.title.x = element_blank()) +
  labs(title = "Letter Grade") 

## Number of Events Indicator
ggplot(data = HxMx) +
  geom_bar(mapping = aes(x = nevents_ind)) +
  scale_y_continuous(name=" ", labels = comma) +
  theme(axis.title.x = element_blank()) +
  labs(title = "Participated in an Event") 

## Number of Days Active Indicator
ggplot(data = HxMx) +
  geom_bar(mapping = aes(x = ndays_act_ind)) +
  scale_y_continuous(name=" ", labels = comma) +
  theme(axis.title.x = element_blank()) +
  labs(title = "Was Active") 

## Number of Video Plays Indicator
ggplot(data = HxMx) +
  geom_bar(mapping = aes(x = nplay_video_ind)) +
  scale_y_continuous(name=" ", labels = comma) +
  theme(axis.title.x = element_blank()) +
  labs(title = "Played Video") 

## Number of Chapters Indicator
ggplot(data = HxMx) +
  geom_bar(mapping = aes(x = nchapters_ind)) +
  scale_y_continuous(name=" ", labels = comma) +
  theme(axis.title.x = element_blank()) +
  labs(title = "Read a Chapter") 

## Short Title
ggplot(data = HxMx) +
  geom_bar(mapping = aes(x = short_title)) +
  scale_y_continuous(name=" ", labels = comma) +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_text(angle=90, vjust=0.5)) +
  labs(title = "Course Short Title") 

## Full Title
## FIX AXIS WRAP
ggplot(data = HxMx) +
  geom_bar(mapping = aes(x = full_title)) +
  scale_y_continuous(name=" ", labels = comma) +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_text(angle=90, vjust=0.5)) +
  labs(title = "Course Full Title") 
